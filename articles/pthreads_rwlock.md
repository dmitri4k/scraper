RW-lock (блокировка чтения-записи, блокировка «много читателей, один писатель») – это примитив синхронизации, который позволяет решить проблему «читателей-писателя»
Проблема «много читателей, один писатель» довольно часто встречается при решении практических задач многопоточного программирования. Такая проблема появляется тогда, когда много потоков читают данные, и один поток пишет (изменяет) данные. Простой подход – использованием мьютекса – считается медленным, так как нет необходимости блокировать ресурс, когда его только читают.
Pthreads решает эту проблему  с помощью блокировки чтения-записи, которая обеспечивает множественный доступ потоков читателей, и эксклюзивный доступ потока писателя.

В отличие от мьютекса, rwlock имеет два набора  функций блокировки-освобождения ресурса – один для потоков читателей, другой для потока писателя. Инициализируется ресурс типа pthread_rwlock_t либо стандартным инициализатором  PTHREAD_RWLOCK_INITIALIZER
, либо функцией



которая принимает в качестве первого аргумента указатель на блокировку, в качестве второго – атрибуты вновь создаваемой блокировки. Во время инициализации, конечно, могут появиться ошибки, из-за которых функция «упадёт»:



Уничтожение блокировки производится с помощью функции

которая может упасть в случае ошибок

Блокировка осуществляется с помощью функций int

для читателя, и

для писателя. Эти функции и возвращаемые ошибки идентичны функциями для работы с мьютексами.

А теперь стандартный неинтересный пример

![mail.png](../images/mail.png)

